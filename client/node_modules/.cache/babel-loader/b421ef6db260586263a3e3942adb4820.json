{"ast":null,"code":"import { createSlice, createAsyncThunk } from \"@reduxjs/toolkit\";\nimport noteService from \"./noteService\";\nconst initialState = {\n  notes: [],\n  isError: false,\n  isSuccess: false,\n  isLoading: false,\n  message: ''\n}; // get task notes\n\nexport const showNotes = createAsyncThunk('notes/getAll', async (taskId, thunkApi) => {\n  try {\n    // @ts-ignore\n    const token = thunkApi.getState().auth.user.token;\n    return await noteService.showNotes(taskId, token);\n  } catch (err) {\n    const message = err.response && err.response.data && err.response.data.message || err.message || err.toString();\n    return thunkApi.rejectWithValue(message);\n  }\n});\nexport const noteSlice = createSlice({\n  name: 'note',\n  initialState,\n  reducers: {\n    reset: state => initialState\n  },\n  extraReducers: builider => {\n    builider.addCase(showNotes.pending, state => {\n      state.isLoading = true;\n    }).addCase(showNotes.fulfilled, (state, action) => {\n      state.isLoading = false;\n      state.isSuccess = true; // TODO:\n\n      state.notes = action.payload;\n    }).addCase(showNotes.rejected, (state, action) => {\n      state.isLoading = false;\n      state.isError = true;\n      state.message = action.payload;\n    });\n  }\n});\nexport const {\n  reset\n} = noteSlice.actions;\nexport default noteSlice.reducer;","map":{"version":3,"sources":["/Users/rickhuang/WebstormProjects/TaskList-Mern/client/src/features/notes/noteSlice.ts"],"names":["createSlice","createAsyncThunk","noteService","initialState","notes","isError","isSuccess","isLoading","message","showNotes","taskId","thunkApi","token","getState","auth","user","err","response","data","toString","rejectWithValue","noteSlice","name","reducers","reset","state","extraReducers","builider","addCase","pending","fulfilled","action","payload","rejected","actions","reducer"],"mappings":"AACA,SAAQA,WAAR,EAAqBC,gBAArB,QAA4C,kBAA5C;AAEA,OAAOC,WAAP,MAAwB,eAAxB;AAyBA,MAAMC,YAA2B,GAAG;AACnCC,EAAAA,KAAK,EAAE,EAD4B;AAEnCC,EAAAA,OAAO,EAAE,KAF0B;AAGnCC,EAAAA,SAAS,EAAE,KAHwB;AAInCC,EAAAA,SAAS,EAAE,KAJwB;AAKnCC,EAAAA,OAAO,EAAE;AAL0B,CAApC,C,CAQA;;AACA,OAAO,MAAMC,SAAS,GAAGR,gBAAgB,CACxC,cADwC,EAExC,OAAOS,MAAP,EAAuBC,QAAvB,KAAoC;AAEnC,MAAI;AAEH;AACA,UAAMC,KAAK,GAAID,QAAQ,CAACE,QAAT,EAAD,CAAmCC,IAAnC,CAAwCC,IAAxC,CAA6CH,KAA3D;AAEA,WAAO,MAAMV,WAAW,CAACO,SAAZ,CAAsBC,MAAtB,EAA8BE,KAA9B,CAAb;AACA,GAND,CAME,OAAOI,GAAP,EAAY;AACb,UAAMR,OAAO,GACXQ,GAAG,CAACC,QAAJ,IAAgBD,GAAG,CAACC,QAAJ,CAAaC,IAA7B,IAAqCF,GAAG,CAACC,QAAJ,CAAaC,IAAb,CAAkBV,OAAxD,IACGQ,GAAG,CAACR,OADP,IAEAQ,GAAG,CAACG,QAAJ,EAHD;AAKA,WAAOR,QAAQ,CAACS,eAAT,CAAyBZ,OAAzB,CAAP;AACA;AACD,CAlBuC,CAAlC;AAqBP,OAAO,MAAMa,SAAS,GAAGrB,WAAW,CAAC;AACpCsB,EAAAA,IAAI,EAAE,MAD8B;AAEpCnB,EAAAA,YAFoC;AAGpCoB,EAAAA,QAAQ,EAAE;AACTC,IAAAA,KAAK,EAAGC,KAAD,IAAWtB;AADT,GAH0B;AAMpCuB,EAAAA,aAAa,EAAGC,QAAD,IAAc;AAC5BA,IAAAA,QAAQ,CACNC,OADF,CACUnB,SAAS,CAACoB,OADpB,EAC8BJ,KAAD,IAAW;AACtCA,MAAAA,KAAK,CAAClB,SAAN,GAAkB,IAAlB;AACA,KAHF,EAIEqB,OAJF,CAIUnB,SAAS,CAACqB,SAJpB,EAI+B,CAACL,KAAD,EAAQM,MAAR,KAAmB;AAChDN,MAAAA,KAAK,CAAClB,SAAN,GAAkB,KAAlB;AACAkB,MAAAA,KAAK,CAACnB,SAAN,GAAkB,IAAlB,CAFgD,CAGhD;;AACAmB,MAAAA,KAAK,CAACrB,KAAN,GAAc2B,MAAM,CAACC,OAArB;AACA,KATF,EAUEJ,OAVF,CAUUnB,SAAS,CAACwB,QAVpB,EAU8B,CAACR,KAAD,EAAQM,MAAR,KAAmB;AAC/CN,MAAAA,KAAK,CAAClB,SAAN,GAAkB,KAAlB;AACAkB,MAAAA,KAAK,CAACpB,OAAN,GAAgB,IAAhB;AACAoB,MAAAA,KAAK,CAACjB,OAAN,GAAgBuB,MAAM,CAACC,OAAvB;AACA,KAdF;AAeA;AAtBmC,CAAD,CAA7B;AA0BP,OAAO,MAAM;AAACR,EAAAA;AAAD,IAAUH,SAAS,CAACa,OAA1B;AACP,eAAeb,SAAS,CAACc,OAAzB","sourcesContent":["\nimport {createSlice, createAsyncThunk} from \"@reduxjs/toolkit\";\nimport {RootState} from \"../../app/store\";\nimport noteService from \"./noteService\";\n\nexport interface NoteType {\n\ttext: string;\n\tisManager?: boolean;\n}\n\nexport interface ResponseNoteType {\n\t_id?:string;\n\tuser?: string;\n\ttask?: string;\n\ttext: string;\n\tisManager: boolean;\n\tcreatedAt?: string;\n\tupdatedAt?: string;\n}\n\nexport interface NoteStateType {\n\tnotes: ResponseNoteType[],\n\tisError: boolean;\n\tisSuccess: boolean;\n\tisLoading: boolean;\n\tmessage: string;\n}\n\nconst initialState: NoteStateType = {\n\tnotes: [],\n\tisError: false,\n\tisSuccess: false,\n\tisLoading: false,\n\tmessage: ''\n}\n\n// get task notes\nexport const showNotes = createAsyncThunk(\n\t'notes/getAll',\n\tasync (taskId: string, thunkApi) => {\n\n\t\ttry {\n\n\t\t\t// @ts-ignore\n\t\t\tconst token = (thunkApi.getState() as RootState).auth.user.token;\n\n\t\t\treturn await noteService.showNotes(taskId, token)\n\t\t} catch (err) {\n\t\t\tconst message =\n\t\t\t\t(err.response && err.response.data && err.response.data.message)\n\t\t\t\t|| err.message ||\n\t\t\t\terr.toString() as string;\n\n\t\t\treturn thunkApi.rejectWithValue(message);\n\t\t}\n\t}\n)\n\nexport const noteSlice = createSlice({\n\tname: 'note',\n\tinitialState,\n\treducers: {\n\t\treset: (state) => initialState\n\t},\n\textraReducers: (builider) => {\n\t\tbuilider\n\t\t\t.addCase(showNotes.pending, (state) => {\n\t\t\t\tstate.isLoading = true;\n\t\t\t})\n\t\t\t.addCase(showNotes.fulfilled, (state, action) => {\n\t\t\t\tstate.isLoading = false;\n\t\t\t\tstate.isSuccess = true;\n\t\t\t\t// TODO:\n\t\t\t\tstate.notes = action.payload\n\t\t\t})\n\t\t\t.addCase(showNotes.rejected, (state, action) => {\n\t\t\t\tstate.isLoading = false;\n\t\t\t\tstate.isError = true;\n\t\t\t\tstate.message = action.payload as string;\n\t\t\t})\n\t}\n})\n\n\nexport const {reset} = noteSlice.actions;\nexport default noteSlice.reducer\n"]},"metadata":{},"sourceType":"module"}